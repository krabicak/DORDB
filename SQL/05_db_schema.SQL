CREATE TABLE KATEGORIE_PREDMETU (
    ZKRATKAKATEGORIE  NVARCHAR2(10) NOT NULL,
    NAZEVKATEGORIE    NVARCHAR2(50) NOT NULL
);

ALTER TABLE KATEGORIE_PREDMETU ADD CONSTRAINT KATEGORIE_PREDMETU_PK PRIMARY KEY ( ZKRATKAKATEGORIE );

CREATE TABLE PRACOVISTE (
    PRACOVISTEID  INTEGER NOT NULL,
    NAZEV         NVARCHAR2(50) NOT NULL,
    ZKRATKA       NVARCHAR2(50) NOT NULL
);

ALTER TABLE PRACOVISTE ADD CONSTRAINT PRACOVISTE_PK PRIMARY KEY ( PRACOVISTEID );

ALTER TABLE PRACOVISTE ADD CONSTRAINT PRACOVISTE__U1 UNIQUE ( ZKRATKA );

CREATE TABLE PRACOVNIK (
    PRACOVNIKID   INTEGER NOT NULL,
    JMENO         NVARCHAR2(50) NOT NULL,
    PRIJMENI      NVARCHAR2(50) NOT NULL,
    TITULPRED     NVARCHAR2(50),
    TITULZA       NVARCHAR2(50),
    TELEFON       NVARCHAR2(50),
    MOBIL         NVARCHAR2(50),
    EMAIL         NVARCHAR2(50),
    PRACOVISTEID  INTEGER,
    HESLO         NVARCHAR2(100) NOT NULL
);

ALTER TABLE PRACOVNIK ADD CONSTRAINT PRACOVNIK_PK PRIMARY KEY ( PRACOVNIKID );

ALTER TABLE PRACOVNIK ADD CONSTRAINT PRACOVNIK__U1 UNIQUE ( MOBIL );

ALTER TABLE PRACOVNIK ADD CONSTRAINT PRACOVNIK__U2 UNIQUE ( EMAIL );

CREATE TABLE PREDMET (
    PREDMETID         INTEGER NOT NULL,
    NAZEV             NVARCHAR2(50) NOT NULL,
    ZKRATKA           NVARCHAR2(50) NOT NULL,
    POCETKREDITU      INTEGER NOT NULL,
    ZKRATKAZAKONCENI  NVARCHAR2(10) NOT NULL,
    ZKRATKAKATEGORIE  NVARCHAR2(10)
);

ALTER TABLE PREDMET ADD CONSTRAINT PREDMET_PK PRIMARY KEY ( PREDMETID );

ALTER TABLE PREDMET ADD CONSTRAINT PREDMET__U1 UNIQUE ( ZKRATKA );

CREATE TABLE UCEBNA (
    POPIS           VARCHAR2(50),
    UCEBNAOZNACENI  VARCHAR2(50) NOT NULL,
    UCEBNAID        INTEGER NOT NULL
);

ALTER TABLE UCEBNA ADD CONSTRAINT UCEBNA_PK PRIMARY KEY ( UCEBNAOZNACENI,
                                                          UCEBNAID );

CREATE TABLE VYUKOVA_AKCE (
    VYUKOVAAKCEID   INTEGER NOT NULL,
    MAXSTUDENTU     INTEGER NOT NULL,
    ZKRATKAZPUSOB   NVARCHAR2(10) NOT NULL,
    PRACOVNIKID     INTEGER,
    POCATEK         DATE,
    KONEC           DATE,
    PREDMETID       INTEGER NOT NULL,
    UCEBNAID        INTEGER,
    UCEBNAOZNACENI  VARCHAR2(50)
);

ALTER TABLE VYUKOVA_AKCE ADD CONSTRAINT VYUKOVA_AKCE_PK PRIMARY KEY ( VYUKOVAAKCEID );

CREATE TABLE ZAKONCENI_PREDMETU (
    ZKRATKAZAKONCENI  NVARCHAR2(10) NOT NULL,
    NAZEVZAKONCENI    NVARCHAR2(50) NOT NULL
);

ALTER TABLE ZAKONCENI_PREDMETU ADD CONSTRAINT ZAKONCENI_PREDMETU_PK PRIMARY KEY ( ZKRATKAZAKONCENI );

CREATE TABLE ZPUSOB_VYUKY (
    ZKRATA        NVARCHAR2(10) NOT NULL,
    NAZEVZPUSOBU  NVARCHAR2(50) NOT NULL
);

ALTER TABLE ZPUSOB_VYUKY ADD CONSTRAINT ZPUSOB_VYUKY_PK PRIMARY KEY ( ZKRATA );

ALTER TABLE PRACOVNIK
    ADD CONSTRAINT PRACOVNIK_PRACOVISTE_FK FOREIGN KEY ( PRACOVISTEID )
        REFERENCES PRACOVISTE ( PRACOVISTEID );

ALTER TABLE PREDMET
    ADD CONSTRAINT PREDMET_KATEGORIE_PREDMETU_FK FOREIGN KEY ( ZKRATKAKATEGORIE )
        REFERENCES KATEGORIE_PREDMETU ( ZKRATKAKATEGORIE );

ALTER TABLE PREDMET
    ADD CONSTRAINT PREDMET_ZAKONCENI_PREDMETU_FK FOREIGN KEY ( ZKRATKAZAKONCENI )
        REFERENCES ZAKONCENI_PREDMETU ( ZKRATKAZAKONCENI );

ALTER TABLE VYUKOVA_AKCE
    ADD CONSTRAINT VYUKOVA_AKCE_PRACOVNIK_FK FOREIGN KEY ( PRACOVNIKID )
        REFERENCES PRACOVNIK ( PRACOVNIKID );

ALTER TABLE VYUKOVA_AKCE
    ADD CONSTRAINT VYUKOVA_AKCE_PREDMET_FK FOREIGN KEY ( PREDMETID )
        REFERENCES PREDMET ( PREDMETID );

ALTER TABLE VYUKOVA_AKCE
    ADD CONSTRAINT VYUKOVA_AKCE_UCEBNA_FK FOREIGN KEY ( UCEBNAOZNACENI,
                                                        UCEBNAID )
        REFERENCES UCEBNA ( UCEBNAOZNACENI,
                            UCEBNAID );

ALTER TABLE VYUKOVA_AKCE
    ADD CONSTRAINT VYUKOVA_AKCE_ZPUSOB_VYUKY_FK FOREIGN KEY ( ZKRATKAZPUSOB )
        REFERENCES ZPUSOB_VYUKY ( ZKRATA );

CREATE SEQUENCE PRACOVISTE_PRACOVISTEID_SEQ START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER PRACOVISTE_PRACOVISTEID_TRG BEFORE
    INSERT ON PRACOVISTE
    FOR EACH ROW
    WHEN ( NEW.PRACOVISTEID IS NULL )
BEGIN
    :NEW.PRACOVISTEID := PRACOVISTE_PRACOVISTEID_SEQ.NEXTVAL;
END;
/

CREATE SEQUENCE PRACOVNIK_PRACOVNIKID_SEQ START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER PRACOVNIK_PRACOVNIKID_TRG BEFORE
    INSERT ON PRACOVNIK
    FOR EACH ROW
    WHEN ( NEW.PRACOVNIKID IS NULL )
BEGIN
    :NEW.PRACOVNIKID := PRACOVNIK_PRACOVNIKID_SEQ.NEXTVAL;
END;
/

CREATE SEQUENCE PREDMET_PREDMETID_SEQ START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER PREDMET_PREDMETID_TRG BEFORE
    INSERT ON PREDMET
    FOR EACH ROW
    WHEN ( NEW.PREDMETID IS NULL )
BEGIN
    :NEW.PREDMETID := PREDMET_PREDMETID_SEQ.NEXTVAL;
END;
/

CREATE SEQUENCE UCEBNA_UCEBNAID_SEQ START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER UCEBNA_UCEBNAID_TRG BEFORE
    INSERT ON UCEBNA
    FOR EACH ROW
    WHEN ( NEW.UCEBNAID IS NULL )
BEGIN
    :NEW.UCEBNAID := UCEBNA_UCEBNAID_SEQ.NEXTVAL;
END;
/

CREATE SEQUENCE VYUKOVA_AKCE_VYUKOVAAKCEID_SEQ START WITH 1 NOCACHE ORDER;

CREATE OR REPLACE TRIGGER VYUKOVA_AKCE_VYUKOVAAKCEID_TRG BEFORE
    INSERT ON VYUKOVA_AKCE
    FOR EACH ROW
    WHEN ( NEW.VYUKOVAAKCEID IS NULL )
BEGIN
    :NEW.VYUKOVAAKCEID := VYUKOVA_AKCE_VYUKOVAAKCEID_SEQ.NEXTVAL;
END;
/